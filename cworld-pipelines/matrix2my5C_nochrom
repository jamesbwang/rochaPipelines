matrixDirectory=$1
sizes=$2
absFile=$3
binName=$4

for filename in $matrixDirectory/*.matrix; do
	echo converting $filename to .my5C ....
	python3 matrix2my5C_nochrom.py $filename $sizes $absFile $binName
done


for filename in $matrixDirectory/*.my5c; do
        echo calculating insulation for $filename ....
	perl matrix2insulation.pl -i $filename
done

echo Aggregating and sorting matrix...
cat *.bed > $absFile.bed
python3 BoundsToTADS.py $absFile.bed $sizes
bedtools sort -i $absFile_reversed.bed > $absFile.sorted.bed

echo Converting to .Bedpe file...
python3 BedToBedpe.py $absFile.sorted.bed
